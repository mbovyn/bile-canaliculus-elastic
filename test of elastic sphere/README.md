# Tests of surface evolver elastic methods

Testing began with the linear_elastic method in surface evolver.
We initially got the result that inflation of a sphere in surface evolver does not agree with the pressure-volume curve derived from linear elastic membrane theory (with the relationship between radius and volume taken from Knoche and Kierfeld PRE 2011).
`esph.fe` does the simulation and `plot_pv.jl` plots it.

We tested the discretization by trying several different refinement levels of the sphere, which all agree as shown in `elastic sphere result multiple rs.pdf`, also generated by `plot_pv.jl`.

We then looked at the general_linear_elastic method.
I derived the elastic coefficient matrix the general method must be using to agree with [the equation describing the linear_elastic method in the docs](http://facstaff.susqu.edu/brakke/evolver/html/quants.htm#linear_elastic).
They can be found in `elastic methods scratch.nb`.

We then tested the general_linear_elastic method.
`gent.fe` and `gent2.fe` are tests of this method on a tringle.
These tests allowed me to figure out how to set the elastic_basis necessary for the method.
I then implemented this on a sphere in `gsph.fe` and output pressure and volume.
The pressure-volume relationship matched the linear_elastic method, as shown in `elastic sphere result linearizations.pdf`, generated by `plot_pv.jl`.

Pierre then hypothesized that the linearization used in surface evolver might not be the same as in Knoche and Kierfeld.
He suggested they might have used a non-linear relationship between the stretch and the strain.
We re-derived the pressure-volume relationship with this non-linear stretch strain relationship in `sphere radius strain linearizations.nb`.
When implemented in `plot_pv.jl`, we find that the non-linear stretch strain relationship fits the surface evolver data perfectly (`elastic sphere result linearizations.pdf`).

# Notes on linear_elastic

## Gram matrix
The Gram matrix is composed of Transpose(V).V where V is a matrix who's columns are the vectors.
This is equivalent to (for two vectors)  
v1.v1 v1.v2  
v2.v1 v2.v2  
Brakke keeps track of s[0]=v1.v1, s[1]=v1.v2=v2.v1, s[2]=v2.v2

## Cauchy-Green matix/tensor
The "Cauchy-Green strain tensor" [mentioned by surface evolver](http://facstaff.susqu.edu/brakke/evolver/html/quants.htm#linear_elastic) is in fact the "Green-Lagrange strain tensor" ([according to this](https://www.comsol.com/multiphysics/analysis-of-deformation)).
This is actually the right Cauchy-Green deformation tensor with the identity matrix subtracted off.

This actually implies FQ=right Cauchy-Green deformation tensor.
Then, QF=Transpose(D).D where D is the deformation gradient (elsewhere called F...).
This seems like it could make sense.

## Creation of form factors
Evolver does not, in fact, assume initial facet shape is unstrained and create form factors for you.

## dim
`web.dimesion` is dimension of surface, should be 2 here
